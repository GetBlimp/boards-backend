box: flenter/multi-python
build:
  steps:

    - install-packages:
        packages: libpq-dev python-dev

    - script:
        name: echo python information
        code: |
          echo "python version $(python --version) running"
          echo "pip version $(pip --version) running"

    - script:
        name: install detox
        code: |
          sudo pip2.7 install detox

    - script:
        name: run tests with detox
        code: |
          detox -v

    - script:
        name: setup virtual environment
        code: |
          sudo pip install virtualenv

    - script:
        name: run tests with tox
        code: |
          tox -v

  after-steps:
    - hipchat-notify:
        token: $HIPCHAT_TOKEN
        room-id: $HIPCHAT_ROOM_ID